schemaVersion: '2.2'
description: Attach an existing security group to selected EC2 instances
mainSteps:
  - action: 'aws:runShellScript'
    name: 'attachSecurityGroup'
    precondition:
      StringEquals:
        - 'ssm:resourceTag/SecurityGroup'
        - 'true'
    inputs:
      runCommand:
        - 'aws ec2 modify-instance-attribute --instance-id {{InstanceId}} --groups {{SecurityGroupId}}'
    parameters:
      - name: SecurityGroupId
        type: String
        description: The ID of the security group to attach
        default: sg-0123456789abcdef0
